@model WeatherInfo.Models.WeatherInfoViewModel
@using PagedList.Mvc;
<link href="~/Content/PagedList.css" rel="stylesheet" type="text/css" />

@{
    ViewBag.Title = "Просмотр архивов погодных условий в г. Москве";
}

<h2>@ViewBag.Title</h2>

@using (Html.BeginForm("Visualize", "Home", FormMethod.Post))
{
    <table>
        <tr>
            <td>
                @{
                    if (Model.year != null)
                    {
                        <input type="text" name="year" size="8" value=@Model.year />
                    }
                    else
                    {
                        <input type="text" name="year" size="8"/>
                    }
                } 

            </td>
            <td>
                @{
                    var months = new string[]
                    {
                        "Январь",
                        "Февраль",
                        "Март",
                        "Апрель",
                        "Май",
                        "Июнь",
                        "Июль",
                        "Август",
                        "Сентябрь",
                        "Октябрь",
                        "Ноябрь",
                        "Декабрь"
                    };
                    var selectInfo = new List<Tuple<String, String, Boolean>>();
                    selectInfo.Add(Tuple.Create("", "", false));

                    for (int i = 0; i < months.Length; ++i)
                    {
                        selectInfo.Add(Tuple.Create((i + 1).ToString(), months[i], Model.month != null && i + 1 == Model.month));
                    }
               }

                <select name="month">
                    @foreach (var s in selectInfo)
                    {
                        if (!s.Item3)
                        {
                            <option value=@s.Item1>@s.Item2</option>
                        }
                        else
                        {
                            <option selected value=@s.Item1>@s.Item2</option>
                        }
                    }
                </select>
            </td>
            <td><input type="submit" name="search" value="Поиск"/></td>
        </tr>
    </table>

    if (Model.errorMessage != null)
    {
        <font size="3" color="red">@Model.errorMessage</font>
    }
    else
    {
        <p>
            Значения столбцов: T- температура воздуха, гр. Ц.; Td - точка росы, гр. Ц.;
            h - нижняя граница облачности, м; VV - горизонтальная видимость, км
        </p>
        <table class="table">
            <tr class="header">
                <td align="center"><p><b>Дата</b></p></td>
                <td align="center"><p><b>Время (московское)</b></p></td>
                <td align="center"><p><b>T</b></p></td>
                <td align="center"><p><b>Отн. влажность воздуха, %</b></p></td>
                <td align="center"><p><b>Td</b></p></td>
                <td align="center"><p><b>Атм. давление, мм. рт. ст.</b></p></td>
                <td align="center"><p><b>Направление ветра</b></p></td>
                <td align="center"><p><b>Скорость ветра, м/с</b></p></td>
                <td align="center"><p><b>Облачность, %</b></p></td>
                <td align="center"><p><b>h</b></p></td>
                <td align="center"><p><b>VV</b></p></td>
                <td align="center"><p><b>Погодные явления</b></p></td>
            </tr>

            @foreach (var item in Model.weatherInfo)
            {
                <tr>
                    <td align="center">
                        @Html.DisplayFor(modelItem => item.Date)
                    </td>
                    <td align="center">
                        @Html.DisplayFor(modelItem => item.Time)
                    </td>
                    <td align="center">
                        @Html.DisplayFor(modelItem => item.Temperature)
                    </td>
                    <td align="center">
                        @Html.DisplayFor(modelItem => item.RelativeHumidity)
                    </td>
                    <td align="center">
                        @Html.DisplayFor(modelItem => item.DewPoint)
                    </td>
                    <td align="center">
                        @Html.DisplayFor(modelItem => item.Pressure)
                    </td>
                    <td align="center">
                        @Html.DisplayFor(modelItem => item.WindDirection)
                    </td>
                    <td align="center">
                        @Html.DisplayFor(modelItem => item.WindVelocity)
                    </td>
                    <td align="center">
                        @Html.DisplayFor(modelItem => item.Claudage)
                    </td>
                    <td align="center">
                        @Html.DisplayFor(modelItem => item.ClaudageLowBound)
                    </td>
                    <td align="center">
                        @Html.DisplayFor(modelItem => item.HorizontallVisibility)
                    </td>
                    <td align="center">
                        @Html.DisplayFor(modelItem => item.WeatherConditions)
                    </td>
                </tr>
            }
            </table>

           <p>Страница @(Model.weatherInfo.PageCount < Model.weatherInfo.PageNumber ? 0 : Model.weatherInfo.PageNumber) из @Model.weatherInfo.PageCount</p>
            @Html.PagedListPager(Model.weatherInfo, page => Url.Action("Visualize", new { page, month = Model.month, year = Model.year }))
    }
}
